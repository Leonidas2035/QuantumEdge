# Supervisor runtime configuration (shared defaults).

mode: "paper"  # paper | demo | off
exchange: ""   # optional: e.g. "bingx_swap"
heartbeat_port: 8765
heartbeat_timeout_s: 15
restart_max_attempts: 3
restart_backoff_s: 5

# HTTP API settings
api_enabled: true
api_host: "127.0.0.1"
api_auth_token: ""  # optional shared secret; empty disables auth
health_path: "/api/v1/dashboard/health"

# Bot process wiring (relative to QE_ROOT)
bot_entrypoint: "ai_scalper_bot/run_bot.py"
bot_workdir: "ai_scalper_bot"
bot_config: "config/bot.yaml"

bot:
  env_file: "config/secrets.local.env"
  auto_start: true
  restart:
    enabled: true
    max_retries: 5
    backoff_seconds: [1, 2, 5, 10, 30]

snapshots:
  enabled: true
  interval_minutes: 5
  history_window_minutes: 15

# Policy publishing (Supervisor -> bot)
policy:
  update_interval_sec: 5
  ttl_sec: 30
  file_path: "runtime/policy.json"
  allow_trading: true
  mode: "normal"   # normal | scalp | risk_off | conservative
  size_multiplier: 1.0
  cooldown_sec: 0
  spread_max_bps: null
  max_daily_loss: null
  reason: "OK"
  hysteresis:
    enter_cycles: 2
    exit_cycles: 3
  thresholds:
    max_daily_loss: null
    max_drawdown_abs: null
    loss_streak: 3
    spread_max_bps: null
    volatility_hi: null
    restart_rate: 3.0
    conservative_size_multiplier: 0.5
    loss_streak_mode: "conservative"

llm:
  enabled: false
  model: "gpt-4.1-mini"
  api_url: "https://api.openai.com/v1/chat/completions"
  api_key_env: "OPENAI_API_KEY_SUPERVISOR"
  timeout_sec: 4
  temperature: 0.1
  circuit_breaker:
    failures: 3
    window_sec: 300
    open_sec: 120

telemetry:
  ingest:
    max_event_size_kb: 32
  store:
    max_events_in_memory: 5000
    persist_path: "runtime/telemetry_store.jsonl"
  alerts:
    cooldown_sec: 120
    thresholds:
      error_rate_1m: 5
      latency_ms: 500
      drawdown_abs: null
      max_daily_loss: null
      restart_rate_per_hour: 3.0
